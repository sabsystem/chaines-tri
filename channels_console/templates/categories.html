{% load static %}
{% load filters %}

<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Tri Chaînes - Catégories</title>

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded"/>
    <link rel="stylesheet" type="text/css" href="{% static 'styles/styles.css' %}">

    <script src="{% static 'scripts/script.js' %}" defer></script>
    <script src="{% static 'scripts/categories.js' %}" defer></script>
</head>

<body>
{% include 'components/header.html' %}

<main>
    <div id="ajout-categorie" class="formulaire">
        <div class="formulaire-contenu">
            <span class="fermer-formulaire" onclick="fermer_formulaire('ajout-categorie')">&times;</span>

            <h1>Ajouter une Catégorie</h1>

            <div>
                <label for="nom-categorie"><b>Nom de la Catégorie à Ajouter</b></label>
                <input type="text" id="nom-categorie" placeholder="Nom de la catégorie...">
            </div>

            <div>
                <label for="diffuser-categorie"><b>Diffuser</b></label>
                <input type="checkbox" id="diffuser-categorie">
            </div>

            <div>
                <label for="equivalences-categorie"><b>Équivalences :</b></label>
                <div id="liste-categories">
                    {% for categorie in categories_github %}
                        <div>
                            <input id="{{ categorie }}" type="checkbox">
                            <label for="{{ categorie }}">{{ categorie }}</label>
                        </div>
                    {% endfor %}
                </div>
            </div>

            <button id="creer-pays" onclick="ajouter_categorie('ajout-categorie')">Créer Catégorie</button>
        </div>
    </div>

    <div id="modification-equivalences" class="formulaire">
        <div class="formulaire-contenu">
            <span class="fermer-formulaire" onclick="fermer_formulaire('modification-equivalences')">&times;</span>

            <h1>Équivalences de la Catégorie : <span id="formulaire-categorie-equivalences">Aucune Catégorie Sélectionnée</span>
            </h1>

            <div id="liste-categories-modif">
                {% for categorie in categories_github %}
                    <div>
                        <input id="{{ categorie }}" type="checkbox">
                        <label for="{{ categorie }}">{{ categorie }}</label>
                    </div>
                {% endfor %}
            </div>

            <button id="modifier-equivalences" onclick="modifier_equivalences('modification-equivalences')">Modifier
                Équivalences
            </button>
        </div>
    </div>

    <h1>CATÉGORIES : {{ categories|length }}</h1>

    <div id="gestion-boutons">
        <div>
            <button class="bouton" onclick="ouvrir_formulaire('ajout-categorie')">Ajouter Catégorie</button>
            <button class="bouton" onclick="enregistrer()">Enregistrer</button>
            <button class="bouton" onclick="window.location.reload()">Réinitialiser</button>
            <button class="bouton" onclick="trier()">Trier</button>
            <label><input class="input" id="filtre" type="text"></label>
            <button class="bouton" onclick="filtrer()">Filtrer</button>
        </div>

        <div>
            <button class="bouton" onclick="pageAvant()"><<</button>
            <label for="chaines-visibles">0-49</label>
            <select class="bouton" id="chaines-visibles" oninput="changerPage()">
                {% for option in categories|length|contenu_pages %}
                    <option value="{{ option }}">{{ option }}</option>
                {% endfor %}
            </select>
            <button class="bouton" onclick="pageApres()">>></button>
        </div>
    </div>

    <section>
        <table>
            <thead>
            <tr>
                <th><span>Numéro <span class="material-symbols-rounded">arrow_drop_down</span></span></th>
                <th><span>Nom Middleware</span></th>
                <th><span>Nom(s) Github</span></th>
                <th><span>Diffuser</span></th>
                <th><span>Actions</span></th>
            </tr>
            </thead>
            <tbody id="zone-tri">
            {% for categorie in categories %}
                <tr id="{{ categorie.nom }}"
                    class="categorie"
                    draggable="true"
                    ondragstart="dragStart(this)"
                    ondragenter="dragEnter(this)"
                    ondragend="dragEnd(this)">
                    <td id="numero">{{ forloop.counter }}</td>
                    <td id="nom" ondblclick="activerModification(this)">{{ categorie.nom }}</td>
                    <td id="equivalence"
                        ondblclick="ouvrir_formulaire_equivalences('modification-equivalences', '{{ categorie.nom }}')">
                        {% for equivalence in categorie.equivalence %}
                            <span style="border-radius: 4px; background-color: #aaaaaa50">{{ equivalence }}</span>
                        {% endfor %}
                    </td>
                    <td id="diffuser" ondblclick="activerModification(this)">{{ categorie.diffuser }}</td>
                    <td>
                        <button class="bouton" onclick="supprimer_categorie('{{ categorie.nom }}')">
                            <span class="material-symbols-rounded"> delete </span>
                        </button>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </section>
</main>

</body>
</html>